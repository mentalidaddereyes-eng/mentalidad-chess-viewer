ğŸ”¥ PRONT INTEGRAL â€” â€œChess.com+ UI + Free Analysis + Play vs Coach + Voz (Leo/Augusto)â€

Objetivo general (todo junto, low-cost):

Tablero interactivo desde el inicio (sin PGN), AnÃ¡lisis Libre ON por defecto.

Jugar contra el Entrenador: el usuario elige color; la IA mueve el lado opuesto y explica mientras juega (texto + voz).

UI estilo chess.com con columnas laterales: acciones a la izquierda, anÃ¡lisis/historial a la derecha.

Botones compactos bajo el tablero (40px alto mÃ¡x), casi sin margen.

Switch Pro/NiÃ±o visible en la barra superior (no debajo).

Anti-scroll: solo scrollean paneles internos.

Multi-PGN real en selector.

Voz: una sola a la vez; Leo = Pro, Augusto = NiÃ±o.

Eliminar â€œLoad Custom Position (FEN)â€ del tablero; mover a Settings â†’ Advanced.

Reglas de costo

Un solo commit. Si necesitas dos, combina cambios y entrega igual en un commit final.

No reinstales dependencias ni cambies toolchain.

MantÃ©n lo ya integrado (Stockfish, voces, etc.).

Tareas (detalle)
A) Layout tipo chess.com (desktop) + mÃ³vil

Implementa grid de 3 columnas (desktop â‰¥1024px):
grid-template-columns: 280px minmax(480px, 720px) 360px; gap: 10â€“12px;

Izquierda (Acciones) â€“ barra vertical con botones grandes (sticky al tablero):
New/Reset Â· Load PGN Â· Load FEN (abre modal) Â· Flip Â· Undo Â· Redo Â· Play/Pause Auto Â· Export PGN Â· Settings Â· (Toggle) Play vs Coach

Centro (Tablero) â€“ canvas cuadrado, centrado, max 720px, aspect-ratio: 1/1.

Debajo del tablero: navegaciÃ³n compacta â® âª â–¶ â© â­ (alto 36â€“40px, gap â‰¤ 6px, mt â‰¤ 6px, mb â‰¤ 8px).

Derecha (AnÃ¡lisis) â€“ tabs: Analysis, Moves, Coach (o Ask integrado). Cada tab con
max-height: 40vh; overflow: auto; sin scroll de pÃ¡gina.

MÃ³vil (â‰¤1023px):

Apilar Tablero arriba y panel lateral abajo como sheet/tabs (Acciones, AnÃ¡lisis, Movidas).

Agrega dock inferior de 5 botones: Load Â· â—€ Â· â–¶ Â· Flip Â· ğŸ™ï¸.

B) AnÃ¡lisis libre por defecto (sin PGN)

Al cargar: game = new Chess(); drag & drop + tap-to-move activados.

onUserMove(fen,lastMove):

Validar con chess.js; actualizar game.

Lanzar Stockfish (depth 12â€“15, timeout 2s); mostrar eval, best move, PV corta, y flecha si â€œMostrar sugerenciasâ€ estÃ¡ ON.

Llamar a coachExplain con tono segÃºn modo:

NiÃ±os (Augusto): 1â€“2 frases simples y motivadoras.

Pro (Leo): eval breve, idea (tÃ¡ctica/posicional) y mini-plan.

Voz: si muted=false, reproducir con canal Ãºnico (detÃ©n la anterior antes de hablar).

C) Jugar contra el Entrenador (tipo chess.com, mejorado)

Toggle â€œPlay vs Coachâ€ (panel izquierdo).

Selector â€œJuego con: Blancas / Negrasâ€.

LÃ³gica de turnos:

Si es turno de IA (Stockfish/coach): calcula mejor jugada, mueve en el tablero, explica (texto y voz si activo).

Si es turno del usuario: mueve; analiza y aconseja.

Botones Ãºtiles: Sugerir jugada (marca flecha, no mueve), Undo/Redo, Reset, Flip.

En mÃ³viles, reduce depth a 10â€“12 si lag.

D) Voz y modos (switch en la barra superior)

Coloca un SegmentedControl visible arriba: Pro | NiÃ±o (no debajo).

Al cambiar de modo:

Voz: Pro => ELEVENLABS_VOICE_PRO, NiÃ±o => ELEVENLABS_VOICE_KIDS (usar secrets).

Tono: adaptar longitudes/explicaciones como arriba.

Persistir en localStorage('coachMode').

BotÃ³n ğŸ™ï¸/ğŸ”‡ cercano al switch. muted=true por defecto.

E) Compactar botonerÃ­a bajo tablero

Estilos sugeridos:
Contenedor: mt-1 mb-2 flex items-center justify-center gap-1
Botones: h-9 px-3 text-sm rounded-md (alto â‰¤ 40px, fuente 14px).

Nada de mÃ¡rgenes grandes ni bloques extra bajo el tablero.

F) Eliminar FEN del tablero; mover a Settings â†’ Advanced

Quita el cuadro â€œLoad Custom Position (FEN)â€ del cuerpo principal.

En Settings â†’ Advanced, agrega toggle â€œEnable FEN Loaderâ€:

Si ON, muestra campo FEN + â€œCargar FENâ€ en un modal o en la pestaÃ±a â€œAccionesâ€.

onLoadFEN(): valida Chess.validate_fen, repinta y evalÃºa de inmediato.

G) Multi-PGN real

Al importar PGN con varias partidas: llenar <select id="gameSelect"> con todas (e.g., â€œBlancas vs Negras Â· Evento Â· Fechaâ€).

Cambiar selecciÃ³n â†’ reconstruir game, repintar, limpiar historial visual, seguir anÃ¡lisis libre.

H) Anti-scroll global + performance

html, body, #root { height: 100%; } contenedor principal min-height: 100dvh; overflow: hidden;

Solo #analysisTab, #movesTab, #coachTab con scroll interno (max-height: 40vh; overflow:auto;).

Debounce de anÃ¡lisis 350â€“500ms; desactivar evaluaciÃ³n mientras se arrastra una pieza.

Ventaja blanca/negra con colores consistentes (mantener lo ya implementado).

I) QA y logs

Al iniciar:
"[mode] free-analysis ready | training=ON | interactive=drag+tap"

Al activar Play vs Coach:
"[mode] play-vs-coach | side=w|b"

En jugadas:
"[coach] onUserMove fen=... eval=..." y "[coach] engineMove ..."

Multi-PGN:
"[games] loaded: N | current: i"

Voz:
"[voice] mode=Pro|Kids | muted=false" (una sola a la vez).

J) Cache-bust / SW

__APP_VERSION__ = "2025-11-01-chesscom-plus"

BotÃ³n â€œActualizar versiÃ³nâ€ que haga postMessage('SKIP_WAITING') â†’ controllerchange â†’ location.reload().

Criterios de aceptaciÃ³n (no cierres hasta cumplir)

âœ… Sin PGN, puedo mover piezas y obtener evaluaciÃ³n + explicaciÃ³n.

âœ… Play vs Coach: elijo color; la IA mueve lo contrario y explica mientras juega.

âœ… UI en columnas laterales (acciones izq., anÃ¡lisis/movidas der.); sin scroll de pÃ¡gina.

âœ… Botones compactos bajo tablero (â‰¤ 40px, poco margen).

âœ… Switch Pro/NiÃ±o visible arriba; cambia voz (Leo/Augusto) y tono al instante; persiste.

âœ… Multi-PGN funcional (selector de partidas).

âœ… FEN loader quitado del tablero; disponible en Settings â†’ Advanced.

âœ… Una sola voz a la vez; sin eco ni solapamientos.

Entrega (un commit):
âœ… Chess.com+ UI + Free Analysis + Play vs Coach + Voz Pro/NiÃ±o + Anti-scroll + Multi-PGN (1 commit)